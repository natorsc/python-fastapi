{% extends 'base/base.html' %}
{% block title %}Ajax com Axios e FastAPI{% endblock %}
{% block css %}
{{ super() }}
<link href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.0/build/styles/base16/material-palenight.min.css"
      rel="stylesheet">
{% endblock %}
{% block content %}
<div class="container">
    <h1 class="text-center">Requisições Ajax com Axios e FastAPI</h1>
    <form class="my-5" id="form">
        <div>
            <label class="form-label" for="firstName">Nome:</label>
            <input class="form-control" id="firstName" maxlength="16" name="firstName" type="text">
            <small class="text-muted">Digite um nome.</small>
        </div>
        <div class="my-5">
            <label class="form-label" for="lastName">Sobrenome:</label>
            <input class="form-control" id="lastName" maxlength="16" name="lastName" type="text">
            <small class="text-muted">Digite um sobrenome.</small>
        </div>
        <button class="btn btn-primary" onclick="sendDataByGet(this)" type="button">
            Dados via GET
        </button>
        <button class="btn btn-primary" onclick="sendDataByPost(this)" type="button">
            Dados via POST
        </button>
    </form>
    <p>Resultado:</p>
    <p id="result">Esse texto será alterado...</p>
    <hr class="my-5">

    <h2>Código JavaScript utilizado</h2>
    <pre><code class="JavaScript">
        
const APIURL = &apos;/v1/ajax/concatenate/names&apos;;

let paragraph = document.getElementById(&apos;result&apos;);
            
function sendDataByGet(button) {
    let firstName = document.getElementById(&apos;firstName&apos;);
    let lastName = document.getElementById(&apos;lastName&apos;);
            
    button.disabled = true;
            
    axios.get(APIURL, {
        params: {
            &apos;first_name&apos;: firstName.value,
            &apos;last_name&apos;: lastName.value,
        }
        }).then((response) =&gt; {
            console.log(&apos;GET&apos;, response);
            paragraph.innerHTML = `Bem vindo
            &lt;b&gt;${response[&apos;data&apos;][&apos;first_name&apos;]}&lt;/b&gt; 
            &lt;b&gt;${response[&apos;data&apos;][&apos;last_name&apos;]}&lt;/b&gt;.`;
        }).finally(() =&gt; {
            button.disabled = false;
        });
}
            
function sendDataByPost(button) {
    let firstName = document.getElementById(&apos;firstName&apos;);
    let lastName = document.getElementById(&apos;lastName&apos;);
            
    button.disabled = true;
            
    // As requisições por padrão são json e utf-8.
    axios.post(APIURL, {
        &apos;first_name&apos;: firstName.value,
        &apos;last_name&apos;: lastName.value,
        }).then((response) =&gt; {
            console.log(&apos;POST&apos;, response);
            paragraph.innerHTML = `Bem vindo
            &lt;b&gt;${response[&apos;data&apos;][&apos;first_name&apos;]}&lt;/b&gt;
            &lt;b&gt;${response[&apos;data&apos;][&apos;last_name&apos;]}&lt;/b&gt;.`;
        }).finally(() =&gt; {
            button.disabled = false;
        });
}
            </code></pre>

</div>
{% endblock %}
{% block js %}
{{ super() }}
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
{% if DEBUG %}
<script src="{{ url_for('static', path='/ajax/js/ajax-axios.js') }}"></script>
{% else %}
<script src="{{ url_for('static', path='/ajax/js/ajax-axios-min.js') }}"></script>
{% endif %}
<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.0/build/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
{% endblock %}